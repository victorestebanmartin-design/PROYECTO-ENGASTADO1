<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Engastado V3.0 - Modo Avanzado</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=v3-1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style-v3.css') }}">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸš€ Sistema de Engastado V3.0</h1>
            <div class="header-actions">
                <a href="{{ url_for('main.progreso_bono') }}" class="btn-secondary" target="_blank" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">ğŸ“Š Dashboard Progreso</a>
                <a href="{{ url_for('main.home') }}" class="btn-secondary">ğŸ”™ Inicio</a>
                <a href="{{ url_for('main.admin') }}" class="btn-admin">âš™ï¸ Admin</a>
            </div>
        </header>

        <!-- SecciÃ³n: Cargar Bono -->
        <div class="card">
            <h2>ğŸ« Cargar Bono de Trabajo</h2>
            <p class="instruccion">Escanea o ingresa el cÃ³digo del bono para comenzar</p>
            
            <div class="input-group">
                <label for="codigo-bono">CÃ³digo de Bono:</label>
                <input type="text" id="codigo-bono" placeholder="Ej: 20251201_1 o 20251201_01" autofocus>
                <small style="color: #6c757d; display: block; margin-top: 5px;">
                    ğŸ’¡ Tip: Puedes usar formato corto (20251201_1) o largo (20251201_01)
                </small>
            </div>
            
            <button onclick="cargarBono()" class="btn-primary">ğŸ” Cargar Bono</button>
            <button onclick="mostrarBonosDisponibles()" class="btn-secondary" style="margin-left: 10px;">ğŸ“‹ Ver Bonos Disponibles</button>
            
            <div id="mensaje" class="mensaje hidden"></div>
            
            <!-- Lista de bonos disponibles -->
            <div id="bonos-disponibles" class="hidden" style="margin-top: 20px; background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #dee2e6;">
                <h4 style="margin-bottom: 10px;">ğŸ“‹ Bonos Activos:</h4>
                <div id="bonos-lista"></div>
            </div>
        </div>

        <!-- InformaciÃ³n del bono cargado -->
        <div id="bono-info" class="card hidden">
            <h2>ğŸ« Bono Cargado</h2>
            <p><strong>Nombre:</strong> <span id="bono-nombre"></span></p>
            <p><strong>Cortes incluidos:</strong> <span id="bono-num-cortes"></span></p>
            <div id="bono-carros-lista" style="margin-top: 10px;">
                <!-- Lista de carros se mostrarÃ¡ aquÃ­ -->
            </div>
        </div>

        <!-- Ãrea principal de trabajo V3 -->
        <div id="workspace-v3" class="workspace-container hidden">
            <!-- Paso 1: SelecciÃ³n de Puesto -->
            <div id="paso-puesto" class="card">
                <h2>ğŸ­ Seleccionar Puesto de Trabajo</h2>
                <p class="instruccion">Selecciona el puesto donde realizarÃ¡s el trabajo</p>
                
                <div class="puestos-grid" id="puestos-grid">
                    <!-- Los puestos se cargarÃ¡n dinÃ¡micamente -->
                </div>
            </div>

            <!-- Paso 2: SelecciÃ³n de MÃ¡quina -->
            <div id="paso-maquina" class="card hidden">
                <h2>ğŸ”§ Seleccionar MÃ¡quina</h2>
                <p class="instruccion">Selecciona la mÃ¡quina en <span id="puesto-seleccionado-nombre"></span></p>
                
                <div class="maquinas-grid" id="maquinas-grid">
                    <!-- Las mÃ¡quinas se cargarÃ¡n dinÃ¡micamente -->
                </div>
                
                <button onclick="volverAPuestos()" class="btn-secondary">ğŸ”™ Cambiar Puesto</button>
            </div>

            <!-- Paso 3: Terminales y Trabajo -->
            <div id="paso-trabajo" class="card hidden">
                <div class="trabajo-header">
                    <h2>âš¡ Terminales de <span id="maquina-seleccionada-nombre"></span></h2>
                    <div class="ruta-trabajo">
                        <span id="ruta-puesto"></span> â†’ <span id="ruta-maquina"></span>
                    </div>
                    <button onclick="cambiarMaquina()" class="btn-secondary">ğŸ”„ Cambiar MÃ¡quina</button>
                </div>

                <!-- Lista de terminales asignados -->
                <div id="terminales-asignados" class="terminales-container">
                    <!-- Los terminales se mostrarÃ¡n aquÃ­ -->
                </div>

                <!-- Ãrea de trabajo (igual que V2) -->
                <div id="area-trabajo" class="workspace-v2">
                    <!-- El Ã¡rea de trabajo V2 se cargarÃ¡ aquÃ­ -->
                </div>
            </div>
        </div>

    </div>

    <script src="{{ url_for('static', filename='js/main-v3.js') }}"></script>
</body>
</html>