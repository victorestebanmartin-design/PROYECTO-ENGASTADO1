<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administraci√≥n - Sistema de Engastado</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>‚öôÔ∏è Administraci√≥n del Sistema</h1>
            <a href="{{ url_for('main.index') }}" class="btn-admin">üîô Volver a Operaci√≥n</a>
        </header>

        <!-- Secci√≥n: Subir Archivo Excel -->
        <div class="card">
            <h2>üì§ Subir Archivo Excel</h2>
            <p class="instruccion">Sube un nuevo archivo Excel con datos de cableado</p>
            
            <form id="upload-form" enctype="multipart/form-data">
                <div class="input-group">
                    <label for="file-upload">Seleccionar Archivo (.xlsx, .xls):</label>
                    <input type="file" id="file-upload" name="file" accept=".xlsx,.xls" required>
                </div>
                
                <button type="submit" class="btn-primary">üì§ Subir Archivo</button>
            </form>
            
            <div id="upload-mensaje" class="mensaje hidden"></div>
        </div>

        <!-- Secci√≥n: Asociar C√≥digo de Barras con Archivo -->
        <div class="card">
            <h2>üîó Asociar C√≥digo de Barras</h2>
            <p class="instruccion">Vincula un c√≥digo de barras con un archivo Excel subido</p>
            
            <form id="asociar-form">
                <div class="input-group">
                    <label for="codigo-barras">C√≥digo de Barras:</label>
                    <input type="text" id="codigo-barras" placeholder="Ej: CORADIA_IT_001" required>
                </div>

                <div class="input-group">
                    <label for="select-archivo">Archivo Excel:</label>
                    <select id="select-archivo" required>
                        <option value="">-- Seleccionar archivo --</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="descripcion">Descripci√≥n:</label>
                    <input type="text" id="descripcion" placeholder="Ej: Listado Cableado Coradia Italia" required>
                </div>

                <div class="input-group">
                    <label for="proyecto">Proyecto (opcional):</label>
                    <input type="text" id="proyecto" placeholder="Ej: Coradia Italia">
                </div>

                <button type="submit" class="btn-primary">‚úÖ Asociar</button>
            </form>
            
            <div id="asociar-mensaje" class="mensaje hidden"></div>
        </div>

        <!-- Secci√≥n: Cortes Registrados -->
        <div class="card">
            <h2>üìã Cortes Registrados</h2>
            <p class="instruccion">Lista de c√≥digos de barras y archivos asociados</p>
            
            <button onclick="cargarCortes()" class="btn-secondary">üîÑ Actualizar Lista</button>
            
            <div id="lista-cortes" class="tabla-container">
                <p class="text-muted">Cargando...</p>
            </div>
        </div>

        <!-- Secci√≥n: Archivos Disponibles -->
        <div class="card">
            <h2>üìÅ Archivos Excel Disponibles</h2>
            <p class="instruccion">Archivos Excel subidos al sistema</p>
            
            <button onclick="cargarArchivos()" class="btn-secondary">üîÑ Actualizar Lista</button>
            
            <div id="lista-archivos" class="tabla-container">
                <p class="text-muted">Cargando...</p>
            </div>
        </div>

        <!-- Secci√≥n: PELIGRO - Resetear Sistema -->
        <div class="card" style="border: 3px solid #ef4444;">
            <h2 style="color: #ef4444;">‚ö†Ô∏è ZONA DE PELIGRO</h2>
            <p class="instruccion" style="color: #dc2626; font-weight: 600;">Esta acci√≥n eliminar√° TODOS los archivos Excel y TODOS los c√≥digos de barras registrados. No se puede deshacer.</p>
            
            <button onclick="resetearSistema()" class="btn-danger" style="background-color: #dc2626; color: white; font-weight: 700;">
                üóëÔ∏è RESETEAR TODO EL SISTEMA
            </button>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
</body>
</html>
